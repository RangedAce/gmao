<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Liste des materiels</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<nav>
  <a href="/">Accueil</a>
  <a href="/tickets">Tickets</a>
  <a href="/materiels">Materiel</a>
  <a href="/clients">Clients</a>
  <span class="right">
    {% if current_user %}
      <a href="/me/password">Mon profil</a>
      {% if is_admin %} | <a href="/users">Gerer les utilisateurs</a>{% endif %}
      | {{ current_user.full_name }} ({{ current_user.role }}) - <a href="/logout">Deconnexion</a>
    {% endif %}
  </span>
</nav>

<main>
  <div class="card">
    <div style="display:flex; justify-content: space-between; align-items:center; gap:12px;">
      <h1>Materiels</h1>
      <div style="display:flex; gap:8px;">
        <a class="btn secondary" href="/materiels/categories">Categories / Types</a>
        <a class="btn" href="/materiels/nouveau">+ Ajouter</a>
      </div>
    </div>

    <table class="mt-2">
      <tr>
        <th>ID</th>
        <th>Client</th>
        <th>Categorie</th>
        <th>Type</th>
        <th>Modele</th>
        <th>No Serie</th>
        <th>Statut</th>
        <th></th>
      </tr>

      {% for m in materiels %}
      <tr>
        <td><a href="/materiels/{{ m.id }}">{{ m.id }}</a></td>
        <td>{{ m.client.nom }}</td>
        <td>{{ m.category.name if m.category else "N/A" }}</td>
        <td>{{ m.materiel_type.name if m.materiel_type else m.type }}</td>
        <td>{{ m.modele }}</td>
        <td>{{ m.numero_serie }}</td>
        <td>{{ m.statut }}</td>
        <td><a href="/materiels/{{ m.id }}/edit">Modifier</a></td>
      </tr>
      {% endfor %}
    </table>
  </div>

  <p class="muted"><a href="/">Retour</a></p>
</main>

</body>
</html>
